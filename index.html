<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Division Explorer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    body {
      background: #f4f7ff;
      color: #1f2933;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      padding: 24px 12px;
    }

    .app {
      width: 100%;
      max-width: 900px;
      background: #ffffff;
      border-radius: 16px;
      box-shadow: 0 10px 25px rgba(15, 23, 42, 0.12);
      padding: 24px 20px 28px;
    }

    .app-header {
      display: flex;
      flex-wrap: wrap;
      gap: 16px;
      align-items: flex-start;
      justify-content: space-between;
      margin-bottom: 20px;
    }

    .title-block h1 {
      font-size: 1.8rem;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .title-block p {
      margin-top: 4px;
      color: #4b5563;
      font-size: 0.95rem;
    }

    .badge {
      background: #e0ecff;
      color: #1d4ed8;
      padding: 6px 12px;
      border-radius: 999px;
      font-size: 0.8rem;
      font-weight: 600;
      white-space: nowrap;
    }

    .tabs {
      display: inline-flex;
      border-radius: 999px;
      background: #e5e7eb;
      padding: 4px;
      gap: 4px;
      margin-top: 10px;
    }

    .tab {
      border-radius: 999px;
      padding: 6px 14px;
      font-size: 0.85rem;
      border: none;
      cursor: pointer;
      background: transparent;
      font-weight: 500;
    }

    .tab.active {
      background: #2563eb;
      color: #ffffff;
    }

    .tab.disabled {
      opacity: 0.5;
      cursor: default;
    }

    .language-row {
      margin-top: 12px;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 6px 10px;
      border-radius: 999px;
      background: #eef2ff;
      border: 1px solid #c7d2fe;
      font-size: 0.85rem;
    }

    .language-select {
      border-radius: 999px;
      border: 1px solid #c7d2fe;
      padding: 4px 10px;
      font-size: 0.85rem;
      background: #ffffff;
      cursor: pointer;
    }

    .card {
      background: #f9fafb;
      border-radius: 14px;
      padding: 16px 16px 18px;
      margin-bottom: 16px;
      border: 1px solid #e5e7eb;
    }

    .card h2 {
      font-size: 1.1rem;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .card p.subtitle {
      font-size: 0.9rem;
      color: #6b7280;
      margin-bottom: 12px;
    }

    .input-row {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      margin-bottom: 12px;
    }

    .field {
      flex: 1 1 140px;
      min-width: 0;
    }

    .field label {
      display: block;
      font-size: 0.85rem;
      margin-bottom: 4px;
      color: #374151;
      font-weight: 500;
    }

    .field input {
      width: 100%;
      padding: 8px 10px;
      border-radius: 10px;
      border: 1px solid #d1d5db;
      font-size: 1rem;
      outline: none;
      transition: border-color 0.15s, box-shadow 0.15s;
    }

    .field input:focus {
      border-color: #2563eb;
      box-shadow: 0 0 0 1px rgba(37, 99, 235, 0.2);
    }

    .btn-row {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 10px;
      margin-top: 4px;
    }

    button.calculate-btn {
      background: #2563eb;
      color: white;
      border: none;
      border-radius: 999px;
      padding: 8px 20px;
      font-size: 0.95rem;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.1s, box-shadow 0.1s, background 0.1s;
      box-shadow: 0 6px 14px rgba(37, 99, 235, 0.35);
    }

    button.calculate-btn:hover {
      background: #1d4ed8;
      transform: translateY(-1px);
    }

    button.calculate-btn:active {
      transform: translateY(0);
      box-shadow: 0 3px 8px rgba(37, 99, 235, 0.4);
    }

    .mic-btn {
      background: #eff6ff;
      color: #1d4ed8;
      border-radius: 999px;
      border: 1px solid #bfdbfe;
      padding: 8px 16px;
      font-size: 0.9rem;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      cursor: pointer;
    }

    .mic-btn:hover {
      background: #dbeafe;
    }

    .hint-text {
      font-size: 0.8rem;
      color: #6b7280;
    }

    .result-section {
      margin-top: 10px;
      border-radius: 12px;
      background: #eef2ff;
      border: 1px solid #c7d2fe;
      padding: 10px 12px;
      font-size: 0.95rem;
    }

    .result-main {
      font-weight: 600;
      margin-bottom: 6px;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .result-main span.equation {
      font-family: "SF Mono", ui-monospace, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    }

    .result-sentence {
      font-size: 0.9rem;
      color: #374151;
      margin-bottom: 4px;
    }

    .factor-section {
      background: #f9fafb;
      border-radius: 12px;
      padding: 10px 12px;
      border: 1px dashed #d1d5db;
      font-size: 0.9rem;
    }

    .factor-section h3 {
      font-size: 0.95rem;
      margin-bottom: 6px;
    }

    .factor-list {
      display: flex;
      flex-direction: column;
      gap: 4px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    }

    .factor-item {
      display: flex;
      flex-wrap: wrap;
      gap: 4px;
      align-items: center;
    }

    .equation-pill {
      padding: 2px 8px;
      border-radius: 999px;
      background: #e5e7eb;
    }

    .error {
      margin-top: 6px;
      color: #b91c1c;
      font-size: 0.85rem;
    }

    .mascot-card {
      margin-top: 10px;
      display: flex;
      align-items: center;
      gap: 10px;
      background: #eff6ff;
      border-radius: 14px;
      padding: 8px 10px;
      border: 1px dashed #bfdbfe;
    }

    .mascot-emoji {
      font-size: 1.8rem;
    }

    .mascot-text {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .mascot-title {
      font-weight: 700;
      font-size: 0.95rem;
    }

    .mascot-subtitle {
      font-size: 0.85rem;
      color: #4b5563;
    }

    @media (max-width: 600px) {
      .app {
        padding: 18px 14px 20px;
      }

      .title-block h1 {
        font-size: 1.4rem;
      }

      .badge {
        margin-top: 8px;
      }
    }
  </style>
</head>
<body>
  <div class="app">
    <header class="app-header">
      <div class="title-block">
        <h1 id="titleText">üßÆ Division Explorer</h1>
        <p id="subtitleText">
          A friendly little lab to try out division and see all the factor pairs of your number.
        </p>
        <div class="tabs">
          <button class="tab active" type="button" id="divisionTab">Division</button>
          <button class="tab disabled" type="button" id="timesTab" title="Coming soon!">
            Times Tables (soon)
          </button>
        </div>
        <div class="language-row">
          <label for="languageSelect" id="languageLabel">Language / ‡§≠‡§æ‡§∑‡§æ:</label>
          <select id="languageSelect" class="language-select">
            <option value="en">English</option>
            <option value="hi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</option>
          </select>
        </div>
      </div>
      <div>
        <div class="badge">
          <span id="badgeText">Built for kids 7‚Äì9 üëßüßëüß†</span>
        </div>
        <div class="card mascot-card">
          <div class="mascot-emoji">ü§ñ</div>
          <div class="mascot-text">
            <div class="mascot-title" id="mascotTitle">Hi, I'm Digi!</div>
            <div class="mascot-subtitle" id="mascotSubtitle">
              Your little math buddy to explore numbers, division, and factor pairs. ‚ú®
            </div>
          </div>
        </div>
      </div>
    </header>

    <section class="card">
      <h2 id="step1Title">Step 1: Enter your division problem ‚úèÔ∏è</h2>
      <p class="subtitle" id="step1Subtitle">
        Choose a number to share and how many equal groups you want.
      </p>

      <div class="input-row">
        <div class="field">
          <label for="dividend" id="dividendLabel">Number to share (dividend)</label>
          <input type="number" id="dividend" placeholder="e.g. 100" min="1">
        </div>
        <div class="field">
          <label for="divisor" id="divisorLabel">Number of groups (divisor)</label>
          <input type="number" id="divisor" placeholder="e.g. 4" min="1">
        </div>
      </div>

      <div class="btn-row">
        <button class="calculate-btn" id="calculateBtn" type="button">
          Show me!
        </button>
        <button class="mic-btn" id="micBtn" type="button">
          üé§ <span id="micBtnText">Speak</span>
        </button>
        <span class="hint-text" id="hintText">Try a big number like 250 or 275 too.</span>
      </div>
      <div id="error" class="error" style="display:none;"></div>
    </section>

    <section class="card">
      <h2 id="step2Title">Step 2: See the answer & story üí°</h2>
      <p class="subtitle" id="step2Subtitle">
        We‚Äôll show you the answer, the matching times-table fact, and all the factor pairs.
      </p>

      <div id="result" class="result-section" style="display:none;">
        <div class="result-main">
          <span id="resultLabel">Result:</span>
          <span class="equation" id="equationText"></span>
        </div>
        <div class="result-sentence" id="storyText"></div>
        <div class="result-sentence" id="timesText"></div>
      </div>

      <div id="factors" class="factor-section" style="display:none; margin-top:10px;">
        <h3 id="factorsTitle">All factor pairs of your number üîç</h3>
        <p id="factorsSubtitle" style="margin-bottom:4px; font-size:0.85rem; color:#6b7280;">
          These are all the ways to multiply two whole numbers to reach your starting number.
        </p>
        <div id="factorList" class="factor-list"></div>
      </div>
    </section>
  </div>

  <script>
    // ---------- Translations ----------
    let currentLanguage = 'en';

    const translations = {
      en: {
        htmlLang: 'en',
        title: 'üßÆ Division Explorer',
        subtitle: 'A friendly little lab to try out division and see all the factor pairs of your number.',
        divisionTab: 'Division',
        timesTab: 'Times Tables (soon)',
        languageLabel: 'Language / ‡§≠‡§æ‡§∑‡§æ:',
        badge: 'Built for kids 7‚Äì9 üëßüßëüß†',
        mascotTitle: "Hi, I'm Digi!",
        mascotSubtitle: 'Your little math buddy to explore numbers, division, and factor pairs. ‚ú®',
        step1Title: 'Step 1: Enter your division problem ‚úèÔ∏è',
        step1Subtitle: 'Choose a number to share and how many equal groups you want.',
        dividendLabel: 'Number to share (dividend)',
        divisorLabel: 'Number of groups (divisor)',
        dividendPlaceholder: 'e.g. 100',
        divisorPlaceholder: 'e.g. 4',
        calculateBtn: 'Show me!',
        micButton: 'Speak',
        hintText: 'Try a big number like 250 or 275 too.',
        step2Title: 'Step 2: See the answer & story üí°',
        step2Subtitle: 'We‚Äôll show you the answer, the matching times-table fact, and all the factor pairs.',
        resultLabel: 'Result:',
        factorsTitle: 'All factor pairs of your number üîç',
        factorsSubtitle: 'These are all the ways to multiply two whole numbers to reach your starting number.',
        listeningMessage: 'Listening... please say something like "100 divided by 4".',
        speechError: 'Sorry, I could not hear properly. Please try again.',
        speechDidntUnderstand: (heard) =>
          `I heard: "${heard}". Please try saying two numbers, like "100 divided by 4".`
      },
      hi: {
        htmlLang: 'hi',
        title: 'üßÆ ‡§≠‡§æ‡§ó ‡§ñ‡•ã‡§ú‡•Ä',
        subtitle: '‡§Ø‡§π ‡§è‡§ï ‡§õ‡•ã‡§ü‡§æ-‡§∏‡§æ ‡§≤‡•à‡§¨ ‡§π‡•à ‡§ú‡§π‡§æ‡§Å ‡§Ü‡§™ ‡§≠‡§æ‡§ó ‡§ï‡§æ ‡§Ö‡§≠‡•ç‡§Ø‡§æ‡§∏ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§î‡§∞ ‡§Ö‡§™‡§®‡•á ‡§®‡§Ç‡§¨‡§∞ ‡§ï‡•á ‡§∏‡§≠‡•Ä ‡§ó‡•Å‡§£‡§®‡§ñ‡§Ç‡§° ‡§¶‡•á‡§ñ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§',
        divisionTab: '‡§≠‡§æ‡§ó (Division)',
        timesTab: '‡§ü‡•á‡§¨‡§≤ (‡§ú‡§≤‡•ç‡§¶ ‡§π‡•Ä)',
        languageLabel: '‡§≠‡§æ‡§∑‡§æ / Language:',
        badge: '7‚Äì9 ‡§∏‡§æ‡§≤ ‡§ï‡•á ‡§¨‡§ö‡•ç‡§ö‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è üëßüßëüß†',
        mascotTitle: '‡§π‡§æ‡§Ø, ‡§Æ‡•à‡§Ç ‡§°‡§ø‡§ó‡•Ä ‡§π‡•Ç‡§Å!',
        mascotSubtitle: '‡§Ü‡§™‡§ï‡§æ ‡§õ‡•ã‡§ü‡§æ ‡§Æ‡•à‡§• ‡§¶‡•ã‡§∏‡•ç‡§§, ‡§ú‡•ã ‡§®‡§Ç‡§¨‡§∞ ‡§î‡§∞ ‡§≠‡§æ‡§ó ‡§Æ‡•á‡§Ç ‡§Æ‡§¶‡§¶ ‡§ï‡§∞‡•á‡§ó‡§æ‡•§ ‚ú®',
        step1Title: '‡§ï‡§¶‡§Æ 1: ‡§Ö‡§™‡§®‡§æ ‡§≠‡§æ‡§ó ‡§∏‡§µ‡§æ‡§≤ ‡§≤‡§ø‡§ñ‡•á‡§Ç ‚úèÔ∏è',
        step1Subtitle: '‡§è‡§ï ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ ‡§ö‡•Å‡§®‡•á‡§Ç ‡§î‡§∞ ‡§¨‡§§‡§æ‡§á‡§è ‡§ï‡§ø ‡§â‡§∏‡•á ‡§ï‡§ø‡§§‡§®‡•á ‡§¨‡§∞‡§æ‡§¨‡§∞ ‡§≠‡§æ‡§ó‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§¨‡§æ‡§Å‡§ü‡§®‡§æ ‡§π‡•à‡•§',
        dividendLabel: '‡§ï‡•Å‡§≤ ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ (‡§ú‡§ø‡§∏‡•á ‡§¨‡§æ‡§Å‡§ü‡§®‡§æ ‡§π‡•à)',
        divisorLabel: '‡§∏‡§Æ‡•Ç‡§π‡•ã‡§Ç ‡§ï‡•Ä ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ',
        dividendPlaceholder: '‡§ú‡•à‡§∏‡•á 100',
        divisorPlaceholder: '‡§ú‡•à‡§∏‡•á 4',
        calculateBtn: '‡§¶‡§ø‡§ñ‡§æ‡§á‡§è!',
        micButton: '‡§¨‡•ã‡§≤‡§ï‡§∞ ‡§≤‡§ø‡§ñ‡•á‡§Ç',
        hintText: '250 ‡§Ø‡§æ 275 ‡§ú‡•à‡§∏‡•Ä ‡§¨‡§°‡§º‡•Ä ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ ‡§≠‡•Ä ‡§Ü‡§ú‡§º‡§Æ‡§æ‡§è‡§Å‡•§',
        step2Title: '‡§ï‡§¶‡§Æ 2: ‡§ú‡§µ‡§æ‡§¨ ‡§î‡§∞ ‡§ï‡§π‡§æ‡§®‡•Ä ‡§¶‡•á‡§ñ‡•á‡§Ç üí°',
        step2Subtitle: '‡§π‡§Æ ‡§Ü‡§™‡§ï‡•ã ‡§ú‡§µ‡§æ‡§¨, ‡§ü‡•á‡§¨‡§≤ ‡§µ‡§æ‡§≤‡§æ ‡§§‡§•‡•ç‡§Ø ‡§î‡§∞ ‡§∏‡§≠‡•Ä ‡§ó‡•Å‡§£‡§®‡§ñ‡§Ç‡§° ‡§¶‡§ø‡§ñ‡§æ‡§è‡§Å‡§ó‡•á‡•§',
        resultLabel: '‡§ú‡§µ‡§æ‡§¨:',
        factorsTitle: '‡§Ü‡§™‡§ï‡•Ä ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ ‡§ï‡•á ‡§∏‡§≠‡•Ä ‡§ó‡•Å‡§£‡§®‡§ñ‡§Ç‡§° üîç',
        factorsSubtitle: '‡§Ø‡•á ‡§µ‡•á ‡§∏‡§≠‡•Ä ‡§§‡§∞‡•Ä‡§ï‡•á ‡§π‡•à‡§Ç ‡§ú‡§ø‡§®‡§∏‡•á ‡§¶‡•ã ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ‡§è‡§Å ‡§Æ‡§ø‡§≤‡§ï‡§∞ ‡§Ü‡§™‡§ï‡•Ä ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ ‡§¨‡§®‡§æ‡§§‡•Ä ‡§π‡•à‡§Ç‡•§',
        listeningMessage: '‡§∏‡•Å‡§® ‡§∞‡§π‡•á ‡§π‡•à‡§Ç... ‡§ï‡•Å‡§õ ‡§ê‡§∏‡§æ ‡§¨‡•ã‡§≤‡§ø‡§è: "100 ‡§ï‡•ã 4 ‡§∏‡•á ‡§≠‡§æ‡§ó"‡•§',
        speechError: '‡§Æ‡§æ‡§´‡§º ‡§ï‡•Ä‡§ú‡§ø‡§è, ‡§∏‡§æ‡§´‡§º ‡§∏‡•Å‡§®‡§æ‡§à ‡§®‡§π‡•Ä‡§Ç ‡§¶‡§ø‡§Ø‡§æ‡•§ ‡§¶‡•ã‡§¨‡§æ‡§∞‡§æ ‡§ï‡•ã‡§∂‡§ø‡§∂ ‡§ï‡§∞‡•á‡§Ç‡•§',
        speechDidntUnderstand: (heard) =>
          `‡§Æ‡•à‡§Ç‡§®‡•á ‡§∏‡•Å‡§®‡§æ: "${heard}"‡•§ ‡§ï‡•É‡§™‡§Ø‡§æ ‡§¶‡•ã ‡§®‡§Ç‡§¨‡§∞ ‡§¨‡•ã‡§≤‡§ø‡§è, ‡§ú‡•à‡§∏‡•á "100 ‡§ï‡•ã 4 ‡§∏‡•á ‡§≠‡§æ‡§ó"‡•§`
      }
    };

    function applyLanguage(lang) {
      currentLanguage = translations[lang] ? lang : 'en';
      const t = translations[currentLanguage];

      document.documentElement.lang = t.htmlLang;

      document.getElementById('titleText').textContent = t.title;
      document.getElementById('subtitleText').textContent = t.subtitle;
      document.getElementById('divisionTab').textContent = t.divisionTab;
      document.getElementById('timesTab').textContent = t.timesTab;
      document.getElementById('languageLabel').textContent = t.languageLabel;
      document.getElementById('badgeText').textContent = t.badge;
      document.getElementById('mascotTitle').textContent = t.mascotTitle;
      document.getElementById('mascotSubtitle').textContent = t.mascotSubtitle;
      document.getElementById('step1Title').textContent = t.step1Title;
      document.getElementById('step1Subtitle').textContent = t.step1Subtitle;
      document.getElementById('dividendLabel').textContent = t.dividendLabel;
      document.getElementById('divisorLabel').textContent = t.divisorLabel;
      document.getElementById('calculateBtn').textContent = t.calculateBtn;
      document.getElementById('micBtnText').textContent = t.micButton;
      document.getElementById('hintText').textContent = t.hintText;
      document.getElementById('step2Title').textContent = t.step2Title;
      document.getElementById('step2Subtitle').textContent = t.step2Subtitle;
      document.getElementById('resultLabel').textContent = t.resultLabel;
      document.getElementById('factorsTitle').textContent = t.factorsTitle;
      document.getElementById('factorsSubtitle').textContent = t.factorsSubtitle;

      const dividendInput = document.getElementById('dividend');
      const divisorInput = document.getElementById('divisor');
      dividendInput.placeholder = t.dividendPlaceholder;
      divisorInput.placeholder = t.divisorPlaceholder;

      // Update speech recognition language if available
      if (recognition) {
        recognition.lang = currentLanguage === 'hi' ? 'hi-IN' : 'en-IN';
      }
    }

    // ---------- Main logic & speech recognition ----------
    const dividendInput = document.getElementById('dividend');
    const divisorInput = document.getElementById('divisor');
    const calculateBtn = document.getElementById('calculateBtn');
    const errorBox = document.getElementById('error');

    const resultBox = document.getElementById('result');
    const equationText = document.getElementById('equationText');
    const storyText = document.getElementById('storyText');
    const timesText = document.getElementById('timesText');

    const factorsBox = document.getElementById('factors');
    const factorList = document.getElementById('factorList');

    const micBtn = document.getElementById('micBtn');
    const languageSelect = document.getElementById('languageSelect');

    let recognition = null;

    if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
      const SR = window.SpeechRecognition || window.webkitSpeechRecognition;
      recognition = new SR();
      recognition.continuous = false;
      recognition.interimResults = false;
      recognition.lang = 'en-IN';
    }

    function clearOutputs() {
      errorBox.style.display = 'none';
      errorBox.textContent = '';
      resultBox.style.display = 'none';
      factorsBox.style.display = 'none';
      equationText.textContent = '';
      storyText.textContent = '';
      timesText.textContent = '';
      factorList.innerHTML = '';
    }

    function calculate() {
      clearOutputs();

      const dividend = parseInt(dividendInput.value, 10);
      const divisor = parseInt(divisorInput.value, 10);

      if (isNaN(dividend) || isNaN(divisor)) {
        errorBox.style.display = 'block';
        errorBox.textContent = 'Please enter both numbers.';
        return;
      }
      if (dividend <= 0 || divisor <= 0) {
        errorBox.style.display = 'block';
        errorBox.textContent = 'Please use positive numbers greater than zero.';
        return;
      }

      const quotient = Math.floor(dividend / divisor);
      const remainder = dividend % divisor;

      const eq =
        dividend + ' √∑ ' + divisor + ' = ' + quotient +
        (remainder ? ' (remainder ' + remainder + ')' : '');
      equationText.textContent = eq;

      const t = translations[currentLanguage];

      const story = remainder === 0
        ? (currentLanguage === 'hi'
          ? `${dividend} ‡§ï‡•ã ${divisor} ‡§¨‡§∞‡§æ‡§¨‡§∞ ‡§≠‡§æ‡§ó‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§¨‡§æ‡§Å‡§ü‡•á‡§Ç ‡§§‡•ã ‡§π‡§∞ ‡§≠‡§æ‡§ó ‡§Æ‡•á‡§Ç ${quotient} ‡§Ü‡§§‡§æ ‡§π‡•à‡•§`
          : `If you share ${dividend} into ${divisor} equal groups, each group gets ${quotient}.`)
        : (currentLanguage === 'hi'
          ? `${dividend} ‡§ï‡•ã ${divisor} ‡§¨‡§∞‡§æ‡§¨‡§∞ ‡§≠‡§æ‡§ó‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§¨‡§æ‡§Å‡§ü‡•á‡§Ç ‡§§‡•ã ‡§π‡§∞ ‡§≠‡§æ‡§ó ‡§Æ‡•á‡§Ç ${quotient} ‡§Ü‡§§‡§æ ‡§π‡•à ‡§î‡§∞ ${remainder} ‡§¨‡§ö ‡§ú‡§æ‡§§‡§æ ‡§π‡•à‡•§`
          : `If you share ${dividend} into ${divisor} equal groups, each group gets ${quotient} and ${remainder} is left over.`);
      storyText.textContent = story;

      if (remainder === 0) {
        timesText.textContent = divisor + ' √ó ' + quotient + ' = ' + dividend;
      } else {
        timesText.textContent =
          (currentLanguage === 'hi'
            ? `‡§ï‡•ç‡§Ø‡•ã‡§Ç‡§ï‡§ø ‡§¨‡§æ‡§ï‡•Ä ‡§¨‡§ö‡§§‡§æ ‡§π‡•à, ‡§á‡§∏‡§≤‡§ø‡§è ${divisor} √ó ${quotient} ‡§ï‡•á‡§µ‡§≤ ${divisor * quotient} ‡§π‡•ã‡§§‡§æ ‡§π‡•à, ${dividend} ‡§®‡§π‡•Ä‡§Ç‡•§`
            : `Because there is a remainder, ${divisor} √ó ${quotient} is only ${divisor * quotient}, not ${dividend}.`);
      }

      resultBox.style.display = 'block';

      const n = dividend;
      const pairs = [];
      for (let i = 1; i * i <= n; i++) {
        if (n % i === 0) {
          const j = n / i;
          pairs.push([i, j]);
        }
      }

      factorList.innerHTML = '';
      pairs.forEach(([a, b]) => {
        const item = document.createElement('div');
        item.className = 'factor-item';

        const mult = document.createElement('span');
        mult.className = 'equation-pill';
        mult.textContent = a + ' √ó ' + b + ' = ' + n;

        const arrow = document.createElement('span');
        arrow.textContent = '‚Üí';

        const div1 = document.createElement('span');
        div1.className = 'equation-pill';
        div1.textContent = n + ' √∑ ' + a + ' = ' + b;

        const div2 = document.createElement('span');
        div2.className = 'equation-pill';
        div2.textContent = n + ' √∑ ' + b + ' = ' + a;

        item.appendChild(mult);
        item.appendChild(arrow);
        item.appendChild(div1);
        item.appendChild(div2);
        factorList.appendChild(item);
      });

      factorsBox.style.display = 'block';
    }

    function handleSpeechResult(text) {
      const t = translations[currentLanguage];
      const lower = text.toLowerCase();
      const nums = lower.match(/\d+/g);

      if (nums && nums.length >= 2) {
        dividendInput.value = parseInt(nums[0], 10);
        divisorInput.value = parseInt(nums[1], 10);
        calculate();
      } else {
        errorBox.style.display = 'block';
        errorBox.textContent = t.speechDidntUnderstand(text);
      }
    }

    if (micBtn) {
      if (recognition) {
        micBtn.addEventListener('click', () => {
          clearOutputs();
          const t = translations[currentLanguage];
          errorBox.style.display = 'block';
          errorBox.textContent = t.listeningMessage;
          recognition.start();
        });

        recognition.onresult = (event) => {
          const text = event.results[0][0].transcript;
          handleSpeechResult(text);
        };

        recognition.onerror = () => {
          const t = translations[currentLanguage];
          errorBox.style.display = 'block';
          errorBox.textContent = t.speechError;
        };

        // onend: do nothing special
      } else {
        // Browser does not support speech recognition
        micBtn.style.display = 'none';
      }
    }

    calculateBtn.addEventListener('click', calculate);

    dividendInput.addEventListener('keypress', function (e) {
      if (e.key === 'Enter') calculate();
    });
    divisorInput.addEventListener('keypress', function (e) {
      if (e.key === 'Enter') calculate();
    });

    if (languageSelect) {
      languageSelect.addEventListener('change', function (e) {
        applyLanguage(e.target.value);
      });
    }

    // Initial language setup
    applyLanguage('en');
  </script>
</body>
</html>
