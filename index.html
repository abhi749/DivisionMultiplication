<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Division Explorer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    body {
      background: #f4f7ff;
      color: #1f2933;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      padding: 24px 12px;
    }

    .app {
      width: 100%;
      max-width: 900px;
      background: #ffffff;
      border-radius: 16px;
      box-shadow: 0 10px 25px rgba(15, 23, 42, 0.12);
      padding: 24px 20px 28px;
    }

    .app-header {
      display: flex;
      flex-wrap: wrap;
      gap: 16px;
      align-items: flex-start;
      justify-content: space-between;
      margin-bottom: 20px;
    }

    .title-block h1 {
      font-size: 1.8rem;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .title-block p {
      margin-top: 4px;
      color: #4b5563;
      font-size: 0.95rem;
    }

    .badge {
      background: #e0ecff;
      color: #1d4ed8;
      padding: 6px 12px;
      border-radius: 999px;
      font-size: 0.8rem;
      font-weight: 600;
    }

    .mascot-card {
      margin-top: 10px;
      display: flex;
      align-items: center;
      gap: 10px;
      background: #eff6ff;
      border-radius: 14px;
      padding: 8px 10px;
      border: 1px dashed #bfdbfe;
    }

    .mascot-emoji {
      font-size: 1.8rem;
    }

    .mascot-text {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .mascot-title {
      font-weight: 700;
      font-size: 0.95rem;
    }

    .mascot-subtitle {
      font-size: 0.85rem;
      color: #4b5563;
    }

    .language-switcher {
      display: flex;
      flex-direction: column;
      gap: 4px;
      align-items: flex-end;
      font-size: 0.85rem;
    }

    .language-switcher label {
      color: #4b5563;
    }

    .language-switcher select {
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid #d1d5db;
      font-size: 0.85rem;
      background: #f9fafb;
    }

    .tabs {
      display: inline-flex;
      border-radius: 999px;
      background: #e5e7eb;
      padding: 4px;
      gap: 4px;
      margin-top: 10px;
    }

    .tab {
      border-radius: 999px;
      padding: 6px 14px;
      font-size: 0.85rem;
      border: none;
      cursor: pointer;
      background: transparent;
      font-weight: 500;
    }

    .tab.active {
      background: #2563eb;
      color: #ffffff;
    }

    .tab.disabled {
      opacity: 0.5;
      cursor: default;
    }

    .card {
      background: #f9fafb;
      border-radius: 14px;
      padding: 16px 16px 18px;
      margin-bottom: 16px;
      border: 1px solid #e5e7eb;
    }

    .card h2 {
      font-size: 1.1rem;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .card p.subtitle {
      font-size: 0.9rem;
      color: #6b7280;
      margin-bottom: 12px;
    }

    .input-row {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      margin-bottom: 12px;
    }

    .field {
      flex: 1 1 140px;
      min-width: 0;
    }

    .field label {
      display: block;
      font-size: 0.85rem;
      margin-bottom: 4px;
      color: #374151;
      font-weight: 500;
    }

    .field input {
      width: 100%;
      padding: 8px 10px;
      border-radius: 10px;
      border: 1px solid #d1d5db;
      font-size: 1rem;
      outline: none;
      transition: border-color 0.15s, box-shadow 0.15s;
    }

    .field input:focus {
      border-color: #2563eb;
      box-shadow: 0 0 0 1px rgba(37, 99, 235, 0.2);
    }

    .btn-row {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-top: 4px;
      flex-wrap: wrap;
    }

    button.calculate-btn {
      background: #2563eb;
      color: white;
      border: none;
      border-radius: 999px;
      padding: 8px 20px;
      font-size: 0.95rem;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.1s, box-shadow 0.1s, background 0.1s;
      box-shadow: 0 6px 14px rgba(37, 99, 235, 0.35);
    }

    button.calculate-btn:hover {
      background: #1d4ed8;
      transform: translateY(-1px);
    }

    button.calculate-btn:active {
      transform: translateY(0);
      box-shadow: 0 3px 8px rgba(37, 99, 235, 0.4);
    }

    button.mic-btn {
      background: #fef3c7;
      color: #92400e;
      border-radius: 999px;
      border: 1px solid #fcd34d;
      padding: 7px 12px;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 0.9rem;
      font-weight: 500;
    }

    button.mic-btn span {
      font-size: 1.1rem;
    }

    button.mic-btn.disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .hint-text {
      font-size: 0.8rem;
      color: #6b7280;
    }

    .result-section {
      margin-top: 10px;
      border-radius: 12px;
      background: #eef2ff;
      border: 1px solid #c7d2fe;
      padding: 10px 12px;
      font-size: 0.95rem;
    }

    .result-main {
      font-weight: 600;
      margin-bottom: 6px;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .result-main span.equation {
      font-family: "SF Mono", ui-monospace, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    }

    .result-sentence {
      font-size: 0.9rem;
      color: #374151;
      margin-bottom: 4px;
    }

    .factor-section {
      background: #f9fafb;
      border-radius: 12px;
      padding: 10px 12px;
      border: 1px dashed #d1d5db;
      font-size: 0.9rem;
    }

    .factor-section h3 {
      font-size: 0.95rem;
      margin-bottom: 6px;
    }

    .factor-list {
      display: flex;
      flex-direction: column;
      gap: 4px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    }

    .factor-item {
      display: flex;
      flex-wrap: wrap;
      gap: 4px;
      align-items: center;
    }

    .equation-pill {
      padding: 2px 8px;
      border-radius: 999px;
      background: #e5e7eb;
    }

    .error {
      margin-top: 6px;
      color: #b91c1c;
      font-size: 0.85rem;
    }

    @media (max-width: 600px) {
      .app {
        padding: 18px 14px 20px;
      }

      .title-block h1 {
        font-size: 1.4rem;
      }
    }
  </style>
</head>
<body>
  <div class="app">
    <header class="app-header">
      <div class="title-block">
        <h1 id="titleText">üßÆ Division Explorer</h1>
        <p id="subtitleText">
          A friendly little lab to try out division and see all the factor pairs of your number.
        </p>
        <div class="tabs">
          <button class="tab active" type="button">Division</button>
          <button class="tab disabled" type="button" title="Coming soon!">Times Tables (soon)</button>
        </div>
        <div class="card mascot-card">
          <div class="mascot-emoji">ü§ñ</div>
          <div class="mascot-text">
            <div class="mascot-title" id="mascotTitle">Hi, I'm Digi!</div>
            <div class="mascot-subtitle" id="mascotSubtitle">
              Your little math buddy to explore numbers, division, and factor pairs. ‚ú®
            </div>
          </div>
        </div>
      </div>
      <div>
        <div class="badge">
          Built for kids 7‚Äì9 üëßüßëüß†
        </div>
        <div class="language-switcher" style="margin-top:10px;">
          <label for="languageSelect" id="languageLabel">Language</label>
          <select id="languageSelect">
            <option value="en">English</option>
            <option value="hi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä (Hindi)</option>
          </select>
        </div>
      </div>
    </header>

    <section class="card">
      <h2 id="step1Title">Step 1: Enter your division problem ‚úèÔ∏è</h2>
      <p class="subtitle" id="step1Subtitle">
        Choose a number to share and how many equal groups you want.
      </p>

      <div class="input-row">
        <div class="field">
          <label for="dividend" id="labelDividend">Number to share (dividend)</label>
          <input type="number" id="dividend" placeholder="e.g. 100" min="1">
        </div>
        <div class="field">
          <label for="divisor" id="labelDivisor">Number of groups (divisor)</label>
          <input type="number" id="divisor" placeholder="e.g. 4" min="1">
        </div>
      </div>

      <div class="btn-row">
        <button class="calculate-btn" id="calculateBtn" type="button">
          Show me!
        </button>
        <button class="mic-btn" id="micBtn" type="button" title="Speak your question">
          <span>üé§</span><span id="micBtnText">Speak it</span>
        </button>
        <span class="hint-text" id="hintText">
          You can also say ‚Äú100 divided by 4‚Äù.
        </span>
      </div>
      <div id="error" class="error" style="display:none;"></div>
    </section>

    <section class="card">
      <h2 id="step2Title">Step 2: See the answer & story üí°</h2>
      <p class="subtitle" id="step2Subtitle">
        We‚Äôll show you the answer, the matching times-table fact, and all the factor pairs.
      </p>

      <div id="result" class="result-section" style="display:none;">
        <div class="result-main">
          <span id="resultLabel">Result:</span>
          <span class="equation" id="equationText"></span>
        </div>
        <div class="result-sentence" id="storyText"></div>
        <div class="result-sentence" id="timesText"></div>
      </div>

      <div id="factors" class="factor-section" style="display:none; margin-top:10px;">
        <h3 id="factorTitle">All factor pairs of your number üîç</h3>
        <p id="factorSubtitle" style="margin-bottom:4px; font-size:0.85rem; color:#6b7280;">
          These are all the ways to multiply two whole numbers to reach your starting number.
        </p>
        <div id="factorList" class="factor-list"></div>
      </div>
    </section>
  </div>

  <script>
    // -------- LANGUAGE HANDLING --------
    const languageSelect = document.getElementById('languageSelect');
    let currentLang = 'en';

    const translations = {
      en: {
        title: 'üßÆ Division Explorer',
        subtitle: 'A friendly little lab to try out division and see all the factor pairs of your number.',
        mascotTitle: "Hi, I'm Digi!",
        mascotSubtitle: 'Your little math buddy to explore numbers, division, and factor pairs. ‚ú®',
        languageLabel: 'Language',
        step1Title: 'Step 1: Enter your division problem ‚úèÔ∏è',
        step1Subtitle: 'Choose a number to share and how many equal groups you want.',
        labelDividend: 'Number to share (dividend)',
        labelDivisor: 'Number of groups (divisor)',
        showMe: 'Show me!',
        micText: 'Speak it',
        hintText: 'You can also say ‚Äú100 divided by 4‚Äù.',
        step2Title: 'Step 2: See the answer & story üí°',
        step2Subtitle: 'We‚Äôll show you the answer, the matching times-table fact, and all the factor pairs.',
        resultLabel: 'Result:',
        factorTitle: 'All factor pairs of your number üîç',
        factorSubtitle: 'These are all the ways to multiply two whole numbers to reach your starting number.',
        errorBoth: 'Please enter both numbers.',
        errorPositive: 'Please use positive numbers greater than zero.',
        storyNoRemainder: (d, v, q) => `If you share ${d} into ${v} equal groups, each group gets ${q}.`,
        storyRemainder: (d, v, q, r) =>
          `If you share ${d} into ${v} equal groups, each group gets ${q} and ${r} is left over.`,
        timesNoRemainder: (d, v, q) => `${v} √ó ${q} = ${d}`,
        timesRemainder: (d, v, q) =>
          `Because there is a remainder, ${v} √ó ${q} is only ${v * q}, not ${d}.`,
        speechNotSupported: 'Voice input is not available in this browser. Try Chrome or Edge.',
        speechListening: 'Listening‚Ä¶',
        speechSpeakIt: 'Speak it'
      },
      hi: {
        title: 'üßÆ ‡§≠‡§æ‡§ó ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§Æ‡§∂‡•Ä‡§®',
        subtitle: '‡§è‡§ï ‡§Æ‡§ú‡§º‡•á‡§¶‡§æ‡§∞ ‡§ú‡§ó‡§π ‡§ú‡§π‡§æ‡§Å ‡§Ü‡§™ ‡§≠‡§æ‡§ó ‡§î‡§∞ ‡§Ö‡§™‡§®‡•á ‡§®‡§Ç‡§¨‡§∞ ‡§ï‡•á ‡§∏‡§≠‡•Ä ‡§ó‡•Å‡§£‡§®‡§ñ‡§Ç‡§° ‡§¶‡•á‡§ñ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§',
        mascotTitle: '‡§®‡§Æ‡§∏‡•ç‡§§‡•á, ‡§Æ‡•à‡§Ç ‡§°‡§ø‡§ú‡§º‡•Ä ‡§π‡•Ç‡§Å!',
        mascotSubtitle: '‡§Æ‡•à‡§Ç ‡§Ü‡§™‡§ï‡§æ ‡§õ‡•ã‡§ü‡§æ ‡§ó‡§£‡§ø‡§§ ‡§µ‡§æ‡§≤‡§æ ‡§¶‡•ã‡§∏‡•ç‡§§ ‡§π‡•Ç‡§Å, ‡§ú‡•ã ‡§≠‡§æ‡§ó ‡§î‡§∞ ‡§ó‡•Å‡§£‡§æ ‡§Æ‡•á‡§Ç ‡§Æ‡§¶‡§¶ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§ ‚ú®',
        languageLabel: '‡§≠‡§æ‡§∑‡§æ',
        step1Title: '‡§ï‡§¶‡§Æ 1: ‡§Ö‡§™‡§®‡§æ ‡§≠‡§æ‡§ó ‡§ï‡§æ ‡§∏‡§µ‡§æ‡§≤ ‡§≤‡§ø‡§ñ‡•á‡§Ç ‚úèÔ∏è',
        step1Subtitle: '‡§ï‡§ø‡§§‡§®‡•Ä ‡§ö‡•Ä‡§ú‡§º‡•á‡§Ç ‡§π‡•à‡§Ç ‡§î‡§∞ ‡§â‡§®‡•ç‡§π‡•á‡§Ç ‡§ï‡§ø‡§§‡§®‡•á ‡§¨‡§∞‡§æ‡§¨‡§∞ ‡§π‡§ø‡§∏‡•ç‡§∏‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§¨‡§æ‡§Å‡§ü‡§®‡§æ ‡§π‡•à, ‡§Ø‡§π ‡§ö‡•Å‡§®‡•á‡§Ç‡•§',
        labelDividend: '‡§ï‡•Å‡§≤ ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ (‡§ú‡§ø‡§∏‡•á ‡§¨‡§æ‡§Å‡§ü‡§®‡§æ ‡§π‡•à)',
        labelDivisor: '‡§¨‡§∞‡§æ‡§¨‡§∞ ‡§π‡§ø‡§∏‡•ç‡§∏‡•ã‡§Ç ‡§ï‡•Ä ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ',
        showMe: '‡§â‡§§‡•ç‡§§‡§∞ ‡§¶‡§ø‡§ñ‡§æ‡§ì!',
        micText: '‡§¨‡•ã‡§≤ ‡§ï‡§∞ ‡§™‡•Ç‡§õ‡•ã',
        hintText: '‡§Ü‡§™ ‡§ê‡§∏‡•á ‡§¨‡•ã‡§≤ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç: ‚Äú100 divided by 4‚Äù.',
        step2Title: '‡§ï‡§¶‡§Æ 2: ‡§â‡§§‡•ç‡§§‡§∞ ‡§î‡§∞ ‡§ï‡§π‡§æ‡§®‡•Ä ‡§¶‡•á‡§ñ‡•á‡§Ç üí°',
        step2Subtitle: '‡§π‡§Æ ‡§Ü‡§™‡§ï‡•ã ‡§â‡§§‡•ç‡§§‡§∞, ‡§ó‡•Å‡§£‡§æ ‡§ï‡•Ä ‡§¨‡§æ‡§§, ‡§î‡§∞ ‡§∏‡§≠‡•Ä ‡§ó‡•Å‡§£‡§®‡§ñ‡§Ç‡§° ‡§¶‡§ø‡§ñ‡§æ‡§è‡§Å‡§ó‡•á‡•§',
        resultLabel: '‡§â‡§§‡•ç‡§§‡§∞:',
        factorTitle: '‡§Ü‡§™‡§ï‡•Ä ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ ‡§ï‡•á ‡§∏‡§≠‡•Ä ‡§ó‡•Å‡§£‡§®‡§ñ‡§Ç‡§° üîç',
        factorSubtitle: '‡§Ø‡•á ‡§µ‡•á ‡§∏‡§æ‡§∞‡•á ‡§™‡•Ç‡§∞‡•á ‡§ú‡•ã‡§°‡§º‡•á ‡§π‡•à‡§Ç ‡§ú‡§ø‡§®‡§∏‡•á ‡§ó‡•Å‡§£‡§æ ‡§ï‡§∞‡§ï‡•á ‡§Ü‡§™‡§ï‡•Ä ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ ‡§¨‡§®‡§§‡•Ä ‡§π‡•à‡•§',
        errorBoth: '‡§ï‡•É‡§™‡§Ø‡§æ ‡§¶‡•ã‡§®‡•ã‡§Ç ‡§®‡§Ç‡§¨‡§∞ ‡§≠‡§∞‡•á‡§Ç‡•§',
        errorPositive: '‡§ï‡•É‡§™‡§Ø‡§æ ‡§∂‡•Ç‡§®‡•ç‡§Ø ‡§∏‡•á ‡§¨‡§°‡§º‡•á ‡§ß‡§®‡§æ‡§§‡•ç‡§Æ‡§ï ‡§®‡§Ç‡§¨‡§∞ ‡§π‡•Ä ‡§á‡§∏‡•ç‡§§‡•á‡§Æ‡§æ‡§≤ ‡§ï‡§∞‡•á‡§Ç‡•§',
        storyNoRemainder: (d, v, q) =>
          `${d} ‡§ï‡•ã ‡§Ö‡§ó‡§∞ ‡§Ü‡§™ ${v} ‡§¨‡§∞‡§æ‡§¨‡§∞ ‡§π‡§ø‡§∏‡•ç‡§∏‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§¨‡§æ‡§Å‡§ü‡•á‡§Ç, ‡§§‡•ã ‡§π‡§∞ ‡§π‡§ø‡§∏‡•ç‡§∏‡•á ‡§Æ‡•á‡§Ç ${q} ‡§Ü‡§è‡§ó‡§æ‡•§`,
        storyRemainder: (d, v, q, r) =>
          `${d} ‡§ï‡•ã ‡§Ö‡§ó‡§∞ ‡§Ü‡§™ ${v} ‡§¨‡§∞‡§æ‡§¨‡§∞ ‡§π‡§ø‡§∏‡•ç‡§∏‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§¨‡§æ‡§Å‡§ü‡•á‡§Ç, ‡§§‡•ã ‡§π‡§∞ ‡§π‡§ø‡§∏‡•ç‡§∏‡•á ‡§Æ‡•á‡§Ç ${q} ‡§Ü‡§è‡§ó‡§æ ‡§î‡§∞ ${r} ‡§¨‡§ö ‡§ú‡§æ‡§è‡§ó‡§æ‡•§`,
        timesNoRemainder: (d, v, q) => `${v} √ó ${q} = ${d}`,
        timesRemainder: (d, v, q) =>
          `‡§ï‡•ç‡§Ø‡•ã‡§Ç‡§ï‡§ø ‡§∂‡•á‡§∑ ‡§¨‡§ö‡§§‡§æ ‡§π‡•à, ‡§á‡§∏‡§≤‡§ø‡§è ${v} √ó ${q} ‡§∏‡§ø‡§∞‡•ç‡§´ ${v * q} ‡§π‡•ã‡§§‡§æ ‡§π‡•à, ${d} ‡§®‡§π‡•Ä‡§Ç‡•§`,
        speechNotSupported: '‡§Ü‡§™‡§ï‡•á ‡§¨‡•ç‡§∞‡§æ‡§â‡§ú‡§º‡§∞ ‡§Æ‡•á‡§Ç ‡§µ‡•â‡§á‡§∏ ‡§á‡§®‡§™‡•Å‡§ü ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡•§ ‡§ï‡•É‡§™‡§Ø‡§æ Chrome ‡§Ø‡§æ Edge ‡§ü‡•ç‡§∞‡§æ‡§á ‡§ï‡§∞‡•á‡§Ç‡•§',
        speechListening: '‡§∏‡•Å‡§® ‡§∞‡§π‡•á ‡§π‡•à‡§Ç‚Ä¶',
        speechSpeakIt: '‡§¨‡•ã‡§≤ ‡§ï‡§∞ ‡§™‡•Ç‡§õ‡•ã'
      }
    };

    function applyLanguage(lang) {
      const t = translations[lang] || translations.en;
      currentLang = lang;

      document.getElementById('titleText').textContent = t.title;
      document.getElementById('subtitleText').textContent = t.subtitle;
      document.getElementById('mascotTitle').textContent = t.mascotTitle;
      document.getElementById('mascotSubtitle').textContent = t.mascotSubtitle;
      document.getElementById('languageLabel').textContent = t.languageLabel;
      document.getElementById('step1Title').textContent = t.step1Title;
      document.getElementById('step1Subtitle').textContent = t.step1Subtitle;
      document.getElementById('labelDividend').textContent = t.labelDividend;
      document.getElementById('labelDivisor').textContent = t.labelDivisor;
      document.getElementById('calculateBtn').textContent = t.showMe;
      document.getElementById('micBtnText').textContent = t.micText;
      document.getElementById('hintText').textContent = t.hintText;
      document.getElementById('step2Title').textContent = t.step2Title;
      document.getElementById('step2Subtitle').textContent = t.step2Subtitle;
      document.getElementById('resultLabel').textContent = t.resultLabel;
      document.getElementById('factorTitle').textContent = t.factorTitle;
      document.getElementById('factorSubtitle').textContent = t.factorSubtitle;
    }

    languageSelect.addEventListener('change', (e) => {
      applyLanguage(e.target.value);
    });

    // Start with English
    applyLanguage('en');

    // -------- MAIN CALCULATION --------
    const dividendInput = document.getElementById('dividend');
    const divisorInput = document.getElementById('divisor');
    const calculateBtn = document.getElementById('calculateBtn');
    const errorBox = document.getElementById('error');

    const resultBox = document.getElementById('result');
    const equationText = document.getElementById('equationText');
    const storyText = document.getElementById('storyText');
    const timesText = document.getElementById('timesText');

    const factorsBox = document.getElementById('factors');
    const factorList = document.getElementById('factorList');

    function t() {
      return translations[currentLang] || translations.en;
    }

    function clearOutputs() {
      errorBox.style.display = 'none';
      errorBox.textContent = '';
      resultBox.style.display = 'none';
      factorsBox.style.display = 'none';
      equationText.textContent = '';
      storyText.textContent = '';
      timesText.textContent = '';
      factorList.innerHTML = '';
    }

    function calculate() {
      clearOutputs();

      const dividend = parseInt(dividendInput.value, 10);
      const divisor = parseInt(divisorInput.value, 10);

      if (isNaN(dividend) || isNaN(divisor)) {
        errorBox.style.display = 'block';
        errorBox.textContent = t().errorBoth;
        return;
      }
      if (dividend <= 0 || divisor <= 0) {
        errorBox.style.display = 'block';
        errorBox.textContent = t().errorPositive;
        return;
      }

      const quotient = Math.floor(dividend / divisor);
      const remainder = dividend % divisor;

      // Show main equation
      const eq = `${dividend} √∑ ${divisor} = ${quotient}` +
        (remainder ? ` (remainder ${remainder})` : '');
      equationText.textContent = eq;

      // Friendly story sentence
      const story = remainder === 0
        ? t().storyNoRemainder(dividend, divisor, quotient)
        : t().storyRemainder(dividend, divisor, quotient, remainder);
      storyText.textContent = story;

      // Times-table connection
      if (remainder === 0) {
        timesText.textContent = t().timesNoRemainder(dividend, divisor, quotient);
      } else {
        timesText.textContent = t().timesRemainder(dividend, divisor, quotient);
      }

      resultBox.style.display = 'block';

      // Factor pairs for the starting number (dividend)
      const n = dividend;
      const pairs = [];
      for (let i = 1; i * i <= n; i++) {
        if (n % i === 0) {
          const j = n / i;
          pairs.push([i, j]);
        }
      }

      factorList.innerHTML = '';
      pairs.forEach(([a, b]) => {
        const item = document.createElement('div');
        item.className = 'factor-item';

        const mult = document.createElement('span');
        mult.className = 'equation-pill';
        mult.textContent = `${a} √ó ${b} = ${n}`;

        const arrow = document.createElement('span');
        arrow.textContent = '‚Üí';

        const div1 = document.createElement('span');
        div1.className = 'equation-pill';
        div1.textContent = `${n} √∑ ${a} = ${b}`;

        const div2 = document.createElement('span');
        div2.className = 'equation-pill';
        div2.textContent = `${n} √∑ ${b} = ${a}`;

        item.appendChild(mult);
        item.appendChild(arrow);
        item.appendChild(div1);
        item.appendChild(div2);
        factorList.appendChild(item);
      });

      factorsBox.style.display = 'block';
    }

    calculateBtn.addEventListener('click', calculate);

    // Let kids press Enter to calculate
    dividendInput.addEventListener('keypress', function (e) {
      if (e.key === 'Enter') calculate();
    });
    divisorInput.addEventListener('keypress', function (e) {
      if (e.key === 'Enter') calculate();
    });

    // -------- VOICE INPUT (MIC) --------
    const micBtn = document.getElementById('micBtn');
    let recognition = null;
    let listening = false;

    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;

    if (!SpeechRecognition) {
      // No support: disable mic
      micBtn.classList.add('disabled');
      micBtn.title = t().speechNotSupported;
      document.getElementById('hintText').textContent = t().speechNotSupported;
    } else {
      recognition = new SpeechRecognition();
      recognition.lang = 'en-US'; // speech language; numbers are understood fine
      recognition.interimResults = false;
      recognition.maxAlternatives = 1;

      micBtn.addEventListener('click', () => {
        if (listening) {
          recognition.stop();
          return;
        }
        listening = true;
        micBtn.classList.add('disabled');
        micBtn.querySelector('#micBtnText').textContent = t().speechListening;
        recognition.start();
      });

      recognition.onresult = (event) => {
        const transcript = event.results[0][0].transcript;
        // Try to find two numbers in the spoken text
        const match = transcript.match(/(\d+)\D+(\d+)/);
        if (match) {
          const first = parseInt(match[1], 10);
          const second = parseInt(match[2], 10);
          dividendInput.value = first;
          divisorInput.value = second;
          calculate();
        } else {
          errorBox.style.display = 'block';
          errorBox.textContent = t().errorBoth;
        }
      };

      recognition.onerror = () => {
        errorBox.style.display = 'block';
        errorBox.textContent = t().speechNotSupported;
      };

      recognition.onend = () => {
        listening = false;
        micBtn.classList.remove('disabled');
        micBtn.querySelector('#micBtnText').textContent = t().speechSpeakIt;
      };
    }
  </script>
</body>
</html>
